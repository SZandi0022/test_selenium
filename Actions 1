from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.common.by import By
from webdriver_manager.chrome import ChromeDriverManager
from time import sleep

class BrowserActionsExecutor:
    """Ú©Ù„Ø§Ø³ Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù…ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø±ÙˆØ±Ú¯Ø±"""
    
    def __init__(self):
        """ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±"""
        print("ğŸš€ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø± Ú©Ø²ÙˆÙ…...")
        self.driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()))
        self.driver.maximize_window()
        print("âœ… Ù…Ø±ÙˆØ±Ú¯Ø± Chrome Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯")
    
    def execute_all_actions(self):
        """Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù…ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ù‡ ØªØ±ØªÛŒØ¨"""
        print("\n" + "="*60)
        print("Ø´Ø±ÙˆØ¹ Ø§Ø¬Ø±Ø§ÛŒ ØªÙ…Ø§Ù…ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø±ÙˆØ±Ú¯Ø±")
        print("="*60)
        
        try:
            self.action_1_open_google_search()
            self.action_2_print_title()
            self.action_3_go_to_wikipedia_back()
            self.action_4_forward_to_wikipedia()
            self.action_5_refresh_page()
            self.action_6_open_new_tab()
            self.action_7_open_new_window()
            self.action_8_get_current_window_handle()
            self.action_9_get_all_window_handles()
            self.action_10_switch_to_main_window()
            self.action_11_close_current_tab()
            
            print("\n" + "="*60)
            print("âœ… ØªÙ…Ø§Ù…ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù†Ø¯")
            print("="*60)
            
        except Exception as e:
            print(f"\nâŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª: {e}")
            raise
    
    def action_1_open_google_search(self):
        """Part 1: Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† Ú¯ÙˆÚ¯Ù„ Ùˆ Ø¬Ø³ØªØ¬Ùˆ"""
        print("\n1ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 1: Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† Ú¯ÙˆÚ¯Ù„ Ùˆ Ø¬Ø³ØªØ¬ÙˆÛŒ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§")
        self.driver.get("https://www.google.com")
        
        search_box = self.driver.find_element(By.NAME, "q")
        search_box.send_keys("https://wikipedia.org")
        sleep(2)
        print("âœ… Ú¯ÙˆÚ¯Ù„ Ø¨Ø§Ø² Ø´Ø¯ Ùˆ Ø¬Ø³ØªØ¬Ùˆ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯")
    
    def action_2_print_title(self):
        """Part 2: Ú†Ø§Ù¾ Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡"""
        print("\n2ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 2: Ù†Ù…Ø§ÛŒØ´ Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡")
        title = self.driver.title
        print(f"ğŸ“„ Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡: {title}")
        print("ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§")
        print("âœ… Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯")
    
    def action_3_go_to_wikipedia_back(self):
        """Part 3: Ø±ÙØªÙ† Ø¨Ù‡ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§ Ùˆ Ø¨Ø§Ø²Ú¯Ø´Øª"""
        print("\n3ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 3: Ø±ÙØªÙ† Ø¨Ù‡ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§ Ùˆ Ø¨Ø§Ø²Ú¯Ø´Øª")
        self.driver.get("https://www.wikipedia.com")
        sleep(1)
        wikipedia_title = self.driver.title
        print(f"ğŸ“„ Ø¹Ù†ÙˆØ§Ù† ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§: {wikipedia_title}")
        
        self.driver.back()
        sleep(1)
        print("ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø² ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§")
        print("âœ… Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯")
    
    def action_4_forward_to_wikipedia(self):
        """Part 4: Ø¬Ù„Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§"""
        print("\n4ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 4: Ø¬Ù„Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§")
        self.driver.forward()
        sleep(1)
        print("ğŸ”œ Ø¬Ù„Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ ÙˆÛŒÚ©ÛŒâ€ŒÙ¾Ø¯ÛŒØ§")
        print("âœ… Ø¹Ù…Ù„ÛŒØ§Øª Ø¬Ù„Ùˆ Ø±ÙØªÙ† Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯")
    
    def action_5_refresh_page(self):
        """Part 5: Ø±ÙØ±Ø´ ØµÙØ­Ù‡"""
        print("\n5ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 5: Ø±ÙØ±Ø´ ØµÙØ­Ù‡")
        self.driver.refresh()
        sleep(1)
        print("ğŸ”„ Ø±ÙØ±Ø´ ØµÙØ­Ù‡")
        print("âœ… ØµÙØ­Ù‡ Ø±ÙØ±Ø´ Ø´Ø¯")
    
    def action_6_open_new_tab(self):
        """Part 6: Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† ØªØ¨ Ø¬Ø¯ÛŒØ¯"""
        print("\n6ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 6: Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† ØªØ¨ Ø¬Ø¯ÛŒØ¯")
        self.driver.switch_to.new_window('tab')
        sleep(1)
        new_tab_title = self.driver.title
        print(f"ğŸ“‘ Ø¹Ù†ÙˆØ§Ù† ØªØ¨ Ø¬Ø¯ÛŒØ¯: {new_tab_title}")
        print("âœ… ØªØ¨ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ø² Ø´Ø¯")
    
    def action_7_open_new_window(self):
        """Part 7: Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯"""
        print("\n7ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 7: Ø¨Ø§Ø²Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯")
        self.driver.switch_to.new_window("window")
        self.driver.get('https://mybista.com')
        sleep(3)
        mybista_title = self.driver.title
        print(f"ğŸªŸ Ø¹Ù†ÙˆØ§Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯ (Mybista): {mybista_title}")
        print("âœ… Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ø² Ø´Ø¯")
    
    def action_8_get_current_window_handle(self):
        """Part 8: Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù†Ø¯Ù„ Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø§Ø±ÛŒ"""
        print("\n8ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 8: Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù†Ø¯Ù„ Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø§Ø±ÛŒ")
        mybista_window = self.driver.current_window_handle
        print(f"ğŸ”§ Ù‡Ù†Ø¯Ù„ Ù¾Ù†Ø¬Ø±Ù‡ Mybista: {mybista_window}")
        sleep(2)
        print("âœ… Ù‡Ù†Ø¯Ù„ Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø§Ø±ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯")
    
    def action_9_get_all_window_handles(self):
        """Part 9: Ø¯Ø±ÛŒØ§ÙØª ØªÙ…Ø§Ù…ÛŒ Ù‡Ù†Ø¯Ù„â€ŒÙ‡Ø§"""
        print("\n9ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 9: Ø¯Ø±ÛŒØ§ÙØª ØªÙ…Ø§Ù…ÛŒ Ù‡Ù†Ø¯Ù„â€ŒÙ‡Ø§")
        all_handles = self.driver.window_handles
        print(f"ğŸ“‹ ØªØ¹Ø¯Ø§Ø¯ Ù‡Ù†Ø¯Ù„â€ŒÙ‡Ø§: {len(all_handles)}")
        
        for i, handle in enumerate(all_handles):
            print(f"   Ù‡Ù†Ø¯Ù„ {i+1}: {handle}")
        
        print("âœ… ØªÙ…Ø§Ù…ÛŒ Ù‡Ù†Ø¯Ù„â€ŒÙ‡Ø§ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯Ù†Ø¯")
        return all_handles
    
    def action_10_switch_to_main_window(self):
        """Part 10: Ø³ÙˆØ¦ÛŒÚ† Ø¨Ù‡ Ù¾Ù†Ø¬Ø±Ù‡ Ø§ØµÙ„ÛŒ"""
        print("\nğŸ”Ÿ  Ø¹Ù…Ù„ÛŒØ§Øª 10: Ø³ÙˆØ¦ÛŒÚ† Ø¨Ù‡ Ù¾Ù†Ø¬Ø±Ù‡ Ø§ØµÙ„ÛŒ")
        all_handles = self.driver.window_handles
        if len(all_handles) > 0:
            self.driver.switch_to.window(all_handles[0])
            sleep(2)
            print("ğŸ”„ Ø³ÙˆØ¦ÛŒÚ† Ø¨Ù‡ Ù¾Ù†Ø¬Ø±Ù‡ Ø§ØµÙ„ÛŒ")
            print("âœ… Ø¨Ù‡ Ù¾Ù†Ø¬Ø±Ù‡ Ø§ØµÙ„ÛŒ Ø¨Ø§Ø²Ú¯Ø´Øª")
    
    def action_11_close_current_tab(self):
        """Part 11: Ø¨Ø³ØªÙ† ØªØ¨ Ø¬Ø§Ø±ÛŒ"""
        print("\n1ï¸âƒ£1ï¸âƒ£  Ø¹Ù…Ù„ÛŒØ§Øª 11: Ø¨Ø³ØªÙ† ØªØ¨ Ø¬Ø§Ø±ÛŒ")
        self.driver.close()
        sleep(1)
        print("âŒ ØªØ¨ Ø¬Ø§Ø±ÛŒ Ø¨Ø³ØªÙ‡ Ø´Ø¯")
    
    def cleanup(self):
        """ØªÙ…ÛŒØ²Ú©Ø§Ø±ÛŒ Ùˆ Ø¨Ø³ØªÙ† Ù…Ø±ÙˆØ±Ú¯Ø±"""
        print("\nğŸ§¹ Ø¹Ù…Ù„ÛŒØ§Øª ØªÙ…ÛŒØ²Ú©Ø§Ø±ÛŒ...")
        try:
            # Ø¨Ø³ØªÙ† ØªÙ…Ø§Ù… ØªØ¨â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡
            for handle in self.driver.window_handles:
                try:
                    self.driver.switch_to.window(handle)
                    self.driver.close()
                except:
                    pass
            
            sleep(1)
            self.driver.quit()
            print("âœ… Ù…Ø±ÙˆØ±Ú¯Ø± Ø¨Ø³ØªÙ‡ Ø´Ø¯")
            
        except Exception as e:
            print(f"âš ï¸  Ø®Ø·Ø§ Ø¯Ø± ØªÙ…ÛŒØ²Ú©Ø§Ø±ÛŒ: {e}")

# Ø§Ø¬Ø±Ø§ÛŒ Ø§ØµÙ„ÛŒ
if __name__ == "__main__":
    browser_executor = BrowserActionsExecutor()
    
    try:
        browser_executor.execute_all_actions()
    except KeyboardInterrupt:
        print("\n\nâ¹ï¸  Ø§Ø¬Ø±Ø§ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± Ù…ØªÙˆÙ‚Ù Ø´Ø¯")
    except Exception as e:
        print(f"\nâŒ Ø®Ø·Ø§ÛŒ ØºÛŒØ±Ù…Ù†ØªØ¸Ø±Ù‡: {e}")
    finally:
        browser_executor.cleanup()
